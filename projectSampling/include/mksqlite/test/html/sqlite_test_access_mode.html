
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>sqlite_test_access_mode</title><meta name="generator" content="MATLAB 7.13"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2016-04-18"><meta name="DC.source" content="sqlite_test_access_mode.m"><style type="text/css">

body {
  background-color: white;
  margin:10px;
}

h1 {
  color: #990000; 
  font-size: x-large;
}

h2 {
  color: #990000;
  font-size: medium;
}

/* Make the text shrink to fit narrow windows, but not stretch too far in 
wide windows. */ 
p,h1,h2,div.content div {
  max-width: 600px;
  /* Hack for IE6 */
  width: auto !important; width: 600px;
}

pre.codeinput {
  background: #EEEEEE;
  padding: 10px;
}
@media print {
  pre.codeinput {word-wrap:break-word; width:100%;}
} 

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #A020F0}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  color: #666666;
  padding: 10px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#3">Without write access the following command will fail...</a></li><li><a href="#4">Create database with some records</a></li><li><a href="#5">Now since the database is existing, we're able to open it with read-only access:</a></li><li><a href="#6">Write access to the database should not be possible:</a></li><li><a href="#7">Now open database in multithreading mode (without further tests</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> sqlite_test_access_mode
</pre><pre class="codeinput">    clear <span class="string">all</span>
    close <span class="string">all</span>
    clc
    dummy = mksqlite(<span class="string">'version mex'</span>);
    fprintf( <span class="string">'\n\n'</span> );


    <span class="comment">% name of test database</span>
    db_name = <span class="string">'sql_test_access2.db'</span>;

    <span class="comment">% delete database file, if exists</span>
    <span class="keyword">if</span> exist( db_name, <span class="string">'file'</span> )
        delete( db_name );
    <span class="keyword">end</span>
</pre><pre class="codeoutput">mksqlite Version 2.2 build: 109, ein MATLAB Interface zu SQLite
(c) 2008-2016 by Martin Kortmann &lt;mail@kortmann.de&gt;
                 Andreas Martin  &lt;andimartin@users.sourceforge.net&gt;
basierend auf SQLite Version 3.10.2 - http://www.sqlite.org
mksqlite verwendet darueber hinaus:
 - DEELX perl kompatible regex engine Version 1.3 (Sswater@gmail.com)
 - BLOSC/LZ4 1.3.0-rc3.dev zur Datenkompression (Francesc Alted / Yann Collett) 
 - MD5 Message-Digest Algorithm (RFC 1321) Implementierung von Alexander Peslyak
   
Platform: PCWIN64, little endian



</pre><h2>Without write access the following command will fail...<a name="3"></a></h2><pre class="codeinput">    <span class="keyword">try</span>
        s = <span class="string">'mksqlite( ''open'', db_name, ''RO'' );'</span>;
        fprintf( [s,<span class="string">'\n'</span>] );
        eval( s ); <span class="comment">% Try to create database with read-only-access (single-thread)</span>
        error( <span class="string">'Test failed!'</span> )
    <span class="keyword">catch</span>
        <span class="comment">% test succeeds, if we ran into this block</span>
        fprintf( <span class="string">'Catch block: Unable to create database with read-only-access, test succeeded!\n'</span> );
    <span class="keyword">end</span>

    <span class="comment">% mksqlite( 'open', db_name ) opens the database with default access rights</span>
    <span class="comment">% and is the same as:</span>
    <span class="comment">% mksqlite( 'open', db_name, 'RWC', 'Single' )</span>
</pre><pre class="codeoutput">mksqlite( 'open', db_name, 'RO' );
Catch block: Unable to create database with read-only-access, test succeeded!
</pre><h2>Create database with some records<a name="4"></a></h2><pre class="codeinput">    mksqlite( <span class="string">'open'</span>, db_name ); <span class="comment">% Open with read/write-access (single-thread)</span>

    <span class="comment">% create a table with a single column and insert one record</span>
    mksqlite( <span class="string">'CREATE TABLE data (Col_1)'</span> );
    mksqlite( <span class="string">'insert into data (Col_1) values( "A String")'</span> );
    mksqlite( <span class="string">'close'</span> );
    fprintf( <span class="string">'Database with one record (%s) has been created\n'</span>, db_name );
</pre><pre class="codeoutput">Database with one record (sql_test_access2.db) has been created
</pre><h2>Now since the database is existing, we're able to open it with read-only access:<a name="5"></a></h2><pre class="codeinput">    fprintf( <span class="string">'Open database with read-only access:\n'</span> );
    s = <span class="string">'mksqlite( ''open'', db_name, ''RO'' );'</span>; <span class="comment">% Open read-only (single-thread)</span>
    fprintf( [s,<span class="string">'\n'</span>] );
    eval( s );
</pre><pre class="codeoutput">Open database with read-only access:
mksqlite( 'open', db_name, 'RO' );
</pre><h2>Write access to the database should not be possible:<a name="6"></a></h2><pre class="codeinput">    <span class="keyword">try</span>
        s = <span class="string">'mksqlite( ''insert into data (Col_1) values( "A String")'' );'</span>;
        fprintf( [s,<span class="string">'\n'</span>] );
        eval( s );
        error( <span class="string">'Test failed!'</span> )
    <span class="keyword">catch</span>
        <span class="comment">% test succeeds, if we ran into this block</span>
        fprintf( <span class="string">'Catch block: Write access denied, test succeeded!\n'</span> );
    <span class="keyword">end</span>
</pre><pre class="codeoutput">mksqlite( 'insert into data (Col_1) values( "A String")' );
Catch block: Write access denied, test succeeded!
</pre><h2>Now open database in multithreading mode (without further tests<a name="7"></a></h2><pre class="codeinput">    fprintf( <span class="string">'Open database in multithreading modes...\n'</span>);
    mksqlite( 0, <span class="string">'close'</span> ); <span class="comment">% Close all open databases</span>
    mksqlite( <span class="string">'open'</span>, db_name, <span class="string">'RW'</span>, <span class="string">'Multi'</span> ); <span class="comment">% Open in multithread-mode</span>
    mksqlite( 0, <span class="string">'close'</span> ); <span class="comment">% Close all open databases</span>
    mksqlite( <span class="string">'open'</span>, db_name, <span class="string">'RW'</span>, <span class="string">'Serial'</span> ); <span class="comment">% Open in multithread-mode (serialized)</span>
    mksqlite( 0, <span class="string">'close'</span> ); <span class="comment">% Close all open databases</span>

    <span class="comment">% No error should have occured</span>
    fprintf( <span class="string">'Tests successfully done.\n'</span> );
</pre><pre class="codeoutput">Open database in multithreading modes...
Tests successfully done.
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.13<br></p></div><!--
##### SOURCE BEGIN #####
function sqlite_test_access_mode

    clear all
    close all
    clc
    dummy = mksqlite('version mex');
    fprintf( '\n\n' );
  
    
    % name of test database
    db_name = 'sql_test_access2.db';

    % delete database file, if exists
    if exist( db_name, 'file' )
        delete( db_name );
    end

    %% Without write access the following command will fail...
    try
        s = 'mksqlite( ''open'', db_name, ''RO'' );';
        fprintf( [s,'\n'] );
        eval( s ); % Try to create database with read-only-access (single-thread)
        error( 'Test failed!' )
    catch
        % test succeeds, if we ran into this block
        fprintf( 'Catch block: Unable to create database with read-only-access, test succeeded!\n' );
    end

    % mksqlite( 'open', db_name ) opens the database with default access rights
    % and is the same as:
    % mksqlite( 'open', db_name, 'RWC', 'Single' )

    %% Create database with some records
    mksqlite( 'open', db_name ); % Open with read/write-access (single-thread)

    % create a table with a single column and insert one record
    mksqlite( 'CREATE TABLE data (Col_1)' );
    mksqlite( 'insert into data (Col_1) values( "A String")' );
    mksqlite( 'close' );
    fprintf( 'Database with one record (%s) has been created\n', db_name );

    %% Now since the database is existing, we're able to open it with read-only access:
    fprintf( 'Open database with read-only access:\n' );
    s = 'mksqlite( ''open'', db_name, ''RO'' );'; % Open read-only (single-thread)
    fprintf( [s,'\n'] );
    eval( s );

    %% Write access to the database should not be possible:
    try
        s = 'mksqlite( ''insert into data (Col_1) values( "A String")'' );';
        fprintf( [s,'\n'] );
        eval( s );
        error( 'Test failed!' )
    catch
        % test succeeds, if we ran into this block
        fprintf( 'Catch block: Write access denied, test succeeded!\n' );
    end

    %% Now open database in multithreading mode (without further tests
    fprintf( 'Open database in multithreading modes...\n');
    mksqlite( 0, 'close' ); % Close all open databases
    mksqlite( 'open', db_name, 'RW', 'Multi' ); % Open in multithread-mode
    mksqlite( 0, 'close' ); % Close all open databases
    mksqlite( 'open', db_name, 'RW', 'Serial' ); % Open in multithread-mode (serialized)
    mksqlite( 0, 'close' ); % Close all open databases

    % No error should have occured
    fprintf( 'Tests successfully done.\n' );

##### SOURCE END #####
--></body></html>